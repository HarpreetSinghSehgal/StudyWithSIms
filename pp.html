<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Projectile Simulator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
    background: linear-gradient(#87CEEB, #E0FFFF);
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  canvas {
    background: #87CEEB;
    display: block;
    margin-top: 10px;
    border: 2px solid #333;
    border-radius: 10px;
  }
  .controls, .stats {
    background: #fff;
    padding: 15px;
    border-radius: 12px;
    margin: 15px;
    width: 90%;
    max-width: 500px;
    box-shadow: 0px 4px 10px rgba(0,0,0,0.2);
  }
  .controls label {
    display: block;
    margin: 8px 0 4px;
    font-weight: bold;
  }
  .controls input[type="range"], 
  .controls select {
    width: 100%;
    margin-bottom: 12px;
  }
  canvas {
    width: 800px;
    height: 500px;
  }
  @media (max-width: 768px) {
    canvas {
      width: 100%;
      height: 60vh;
    }
    .target {
      display: none;
    }
    input[type="range"] {
      height: 35px;
    }
  }
  #rotateWarning {
    position: fixed; 
    top: 0; left: 0; 
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.85);
    color: white; 
    font-size: 22px;
    display: none;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 20px;
    z-index: 9999;
  }
</style>
</head>
<body>
<h2>Projectile Simulator</h2>
<canvas id="simCanvas" width="800" height="500"></canvas>

<div class="controls">
  <label for="projectile">Projectile:</label>
  <select id="projectile">
    <option value="cannonball">Cannonball</option>
    <option value="arrow">Arrow</option>
    <option value="rocket">Rocket</option>
  </select>

  <label for="angle">Angle: <span id="angleVal">45</span>¬∞</label>
  <input type="range" id="angle" min="10" max="80" value="45">

  <label for="velocity">Velocity: <span id="velVal">50</span> m/s</label>
  <input type="range" id="velocity" min="10" max="100" value="50">

  <button onclick="launch()">Launch</button>
</div>

<div class="stats">
  <h3>Stats</h3>
  <p>Range: <span id="rangeVal">0</span> m</p>
  <p>Max Height: <span id="heightVal">0</span> m</p>
  <p>Time of Flight: <span id="timeVal">0</span> s</p>
</div>

<div id="rotateWarning">
  Please rotate your device to landscape for the best experience üì±‚ÜîÔ∏è
</div>

<script>
const canvas = document.getElementById("simCanvas");
const ctx = canvas.getContext("2d");

let angleSlider = document.getElementById("angle");
let velocitySlider = document.getElementById("velocity");
let angleVal = document.getElementById("angleVal");
let velVal = document.getElementById("velVal");

angleSlider.oninput = () => { angleVal.textContent = angleSlider.value; };
velocitySlider.oninput = () => { velVal.textContent = velocitySlider.value; };

// Projectile properties
let projectile = {x: 50, y: 450, vx: 0, vy: 0, radius: 12, launched: false, type: "cannonball"};
let gravity = 0.5;

// Stats
let rangeVal = document.getElementById("rangeVal");
let heightVal = document.getElementById("heightVal");
let timeVal = document.getElementById("timeVal");
let startX, startY, maxHeight, flightStartTime;

// Targets
let targets = [
  {x: 200, y: 400, w: 50, h: 80, color: "gold"},
  {x: 300, y: 380, w: 60, h: 100, color: "green"},
  {x: 420, y: 390, w: 50, h: 90, color: "blue"},
  {x: 500, y: 420, w: 40, h: 60, color: "purple"}
];

// Explosions
let explosions = [];

function drawGround() {
  ctx.fillStyle = "green";
  ctx.fillRect(0, 470, canvas.width, 30);
}

function drawProjectile() {
  if (projectile.type === "cannonball") {
    ctx.beginPath();
    ctx.arc(projectile.x, projectile.y, 12, 0, Math.PI*2);
    ctx.fillStyle = "gray";
    ctx.fill();
    ctx.closePath();
  } else if (projectile.type === "arrow") {
    ctx.fillStyle = "brown";
    ctx.fillRect(projectile.x, projectile.y-2, 25, 4);
    ctx.fillStyle = "black";
    ctx.beginPath();
    ctx.moveTo(projectile.x+25, projectile.y);
    ctx.lineTo(projectile.x+35, projectile.y-5);
    ctx.lineTo(projectile.x+35, projectile.y+5);
    ctx.closePath();
    ctx.fill();
  } else if (projectile.type === "rocket") {
    ctx.fillStyle = "red";
    ctx.beginPath();
    ctx.ellipse(projectile.x, projectile.y, 10, 20, 0, 0, Math.PI*2);
    ctx.fill();
  }
}

function drawTargets() {
  targets.forEach(t => {
    ctx.fillStyle = t.color;
    ctx.fillRect(t.x, t.y, t.w, t.h);
  });
}

function drawExplosions() {
  explosions.forEach(exp => {
    ctx.beginPath();
    ctx.arc(exp.x, exp.y, exp.r, 0, Math.PI*2);
    ctx.fillStyle = exp.color;
    ctx.fill();
  });
  explosions = explosions.filter(exp => exp.r < 40);
  explosions.forEach(exp => exp.r += 2);
}

function resetProjectile() {
  projectile.x = 50;
  projectile.y = 450;
  projectile.vx = 0;
  projectile.vy = 0;
  projectile.launched = false;
  projectile.type = document.getElementById("projectile").value;
  maxHeight = projectile.y;
}

function launch() {
  resetProjectile();
  let angle = Number(angleSlider.value) * Math.PI/180;
  let velocity = Number(velocitySlider.value);
  projectile.vx = velocity * Math.cos(angle);
  projectile.vy = -velocity * Math.sin(angle);
  projectile.launched = true;
  startX = projectile.x;
  startY = projectile.y;
  flightStartTime = Date.now();
}

function checkCollision() {
  for (let i = 0; i < targets.length; i++) {
    let t = targets[i];
    if (projectile.x > t.x && projectile.x < t.x + t.w &&
        projectile.y > t.y && projectile.y < t.y + t.h) {
      // Explosion effect
      explosions.push({x: projectile.x, y: projectile.y, r: 10, color: "orange"});
      targets.splice(i, 1);
      projectile.launched = false;
      break;
    }
  }
}

function update() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawGround();
  drawTargets();
  drawExplosions();

  if (projectile.launched) {
    projectile.x += projectile.vx * 0.3;
    projectile.y += projectile.vy * 0.3;
    projectile.vy += gravity;

    if (projectile.y < maxHeight) maxHeight = projectile.y;

    checkCollision();

    if (projectile.y + 10 >= 470) {
      projectile.launched = false;
      let flightTime = (Date.now() - flightStartTime) / 1000;
      let range = (projectile.x - startX).toFixed(1);
      let height = (startY - maxHeight).toFixed(1);
      rangeVal.textContent = range;
      heightVal.textContent = height;
      timeVal.textContent = flightTime.toFixed(1);
    }
  }

  if (projectile.launched) {
    drawProjectile();
  }

  requestAnimationFrame(update);
}

// Touch-friendly sliders
document.querySelectorAll('input[type="range"]').forEach(slider => {
  slider.addEventListener("touchmove", (e) => {
    let touch = e.touches[0];
    let rect = slider.getBoundingClientRect();
    let percent = (touch.clientX - rect.left) / rect.width;
    slider.value = Math.min(slider.max, Math.max(slider.min,
      Math.round(percent * (slider.max - slider.min) + Number(slider.min))
    ));
    slider.dispatchEvent(new Event('input'));
  });
});

// Rotate check
function checkOrientation() {
  if (window.innerHeight > window.innerWidth && window.innerWidth < 900) {
    document.getElementById("rotateWarning").style.display = "flex";
    document.getElementById("simCanvas").style.display = "none";
    document.querySelector(".controls").style.display = "none";
    document.querySelector(".stats").style.display = "none";
  } else {
    document.getElementById("rotateWarning").style.display = "none";
    document.getElementById("simCanvas").style.display = "block";
    document.querySelector(".controls").style.display = "block";
    document.querySelector(".stats").style.display = "block";
  }
}
window.addEventListener("resize", checkOrientation);
window.addEventListener("load", checkOrientation);

update();
</script>
</body>
</html>

